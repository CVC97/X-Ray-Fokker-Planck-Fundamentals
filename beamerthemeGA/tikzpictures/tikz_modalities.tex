\newcommand{\phaserefraction}{
    \begin{tikzpicture}[domain=0:2.5, samples=200, scale=1]
    
        % beam to sample
        \draw[->, gray, line width=1pt] (0,0) -- (3.5,0) node[right, gray] {$z$};
        
        \draw[->, black, line width=1pt] (0,1) -- (0.75,1);
        \draw[-, black, line width=1pt] (0,1) -- (1.125,1);
        \draw[-, red, line width=1pt] (1.125,1) -- (3,1.5);
        % \draw [draw=black, line width=0.25, fill=gray] (1, 0.5) rectangle (1.5,1.5);
        \draw[draw=black, fill=gray, fill opacity=0.5] (1, 0.5) -- (1, 1.5) -- (1.5, 0.5) -- cycle;
        
        % beam profile
        \def\intensity{2}
        \def\sigma{0.4}
        \def\mu{1.25}
    
        \def\xprofileshift{5.5}
        \draw[->, gray, line width=1pt] (\xprofileshift+0,0) -- (\xprofileshift+3,0) node[right, gray] {$x$};
        \draw[->, gray, line width=1pt] (\xprofileshift+0,0) -- (\xprofileshift+0,2) node[above, gray] {$I$};
        
        \draw[color=black, line width=1pt]    plot (\x+\xprofileshift, {\intensity*exp(-((\x-\mu)/\sigma)^2/\sigma});
        \draw[color=red, line width=1pt, densely dashed]    plot (\x+\xprofileshift, {\intensity*exp(-((\x-(\mu+0.5))/\sigma)^2/\sigma});
        
    \end{tikzpicture}
}


\newcommand{\darkfieldscatter}{
    \begin{tikzpicture}[domain=0:2.5, samples=200, scale=1]
            
        % beam to sample
        \draw[->, gray, line width=1pt] (0,0) -- (3.5,0) node[right, gray] {$z$};
        
        % \draw[black, line width=0.25mm] (1.5, 1) circle [x radius=0.25, y radius=0.5];
        \draw[->, black, line width=1pt] (0,1) -- (0.75,1);
        \draw[-, black, line width=1pt] (0,1) -- (1.25,1);
        % dark field as triangle
        \draw[-, blue, line width=1pt] (1.25,1) -- (3,1);
        \draw[draw=blue, fill=blue] (1.12, 1) -- (3, 1+0.1) -- (3, 1-0.1) -- cycle;
        \draw [draw=black, line width=0.25, fill=gray, fill opacity=0.5] (1, 0.5) rectangle (1.5,1.5);
    
        % microsctructures in rect
        \draw[color=black, fill=black] (1.2105854522337227, 1.2148163811061041) circle (0.0125);
        \draw[color=black, fill=black] (1.0125543280382387, 0.8072742583160437) circle (0.0125);
        \draw[color=black, fill=black] (1.0822090481381286, 0.6025301298995778) circle (0.0125);
        \draw[color=black, fill=black] (1.1009736004043937, 0.8494217088669715) circle (0.0125);
        \draw[color=black, fill=black] (1.2009645502595683, 1.037846315653273) circle (0.0125);
        \draw[color=black, fill=black] (1.2116173943415651, 1.1805890128868404) circle (0.0125);
        \draw[color=black, fill=black] (1.1096148186224708, 1.368664500481172) circle (0.0125);
        \draw[color=black, fill=black] (1.025509106769015, 1.1662058224239422) circle (0.0125);
        \draw[color=black, fill=black] (1.2107197811243853, 1.057222582734608) circle (0.0125);
        \draw[color=black, fill=black] (1.079183795832736, 0.7056489518577568) circle (0.0125);
        \draw[color=black, fill=black] (1.39285367012088, 1.4565550363264126) circle (0.0125);
        \draw[color=black, fill=black] (1.1613764846256402, 1.1875145502775812) circle (0.0125);
        \draw[color=black, fill=black] (1.4287848473406182, 1.3847414969162513) circle (0.0125);
        \draw[color=black, fill=black] (1.0528960004006445, 0.5505784136520603) circle (0.0125);
        \draw[color=black, fill=black] (1.0931694492931703, 1.3686889408436778) circle (0.0125);
        \draw[color=black, fill=black] (1.0592147460706987, 0.9230799343799259) circle (0.0125);
        \draw[color=black, fill=black] (1.4674975268214885, 1.0323361528486916) circle (0.0125);
        \draw[color=black, fill=black] (1.3411416291264748, 0.8201277402309113) circle (0.0125);
        \draw[color=black, fill=black] (1.3385879406487522, 1.3262600300999385) circle (0.0125);
        \draw[color=black, fill=black] (1.021186931738491, 1.2438907070713432) circle (0.0125);
        \draw[color=black, fill=black] (1.482209017230585, 1.2419615130203434) circle (0.0125);
        \draw[color=black, fill=black] (1.1457108962305924, 1.2820473452402013) circle (0.0125);
        \draw[color=black, fill=black] (1.0615323531243799, 0.9491961880215075) circle (0.0125);
        \draw[color=black, fill=black] (1.4440828639692205, 0.7987737946643375) circle (0.0125);
        \draw[color=black, fill=black] (1.1491932858285157, 0.6392778578153206) circle (0.0125);
        \draw[color=black, fill=black] (1.0216993049883911, 1.1743646446163938) circle (0.0125);
        \draw[color=black, fill=black] (1.113023355100028, 0.7714079928879205) circle (0.0125);
        \draw[color=black, fill=black] (1.2459972506581607, 0.5645284814891534) circle (0.0125);
        \draw[color=black, fill=black] (1.2852058626087062, 0.6555603605331648) circle (0.0125);
        \draw[color=black, fill=black] (1.29242013002906, 1.194764401020408) circle (0.0125);
        \draw[color=black, fill=black] (1.0611088536932172, 0.9162045881240791) circle (0.0125);
        \draw[color=black, fill=black] (1.3423400749206789, 0.91632478778873) circle (0.0125);
        \draw[color=black, fill=black] (1.0362278929993913, 1.0349989957676238) circle (0.0125);
        \draw[color=black, fill=black] (1.3278024564793998, 1.0145168842568508) circle (0.0125);
        \draw[color=black, fill=black] (1.4611825090956363, 1.084391164489443) circle (0.0125);
        \draw[color=black, fill=black] (1.4416159097617447, 0.6465378365425816) circle (0.0125);
        \draw[color=black, fill=black] (1.0786562649441103, 1.2997065064917859) circle (0.0125);
        \draw[color=black, fill=black] (1.2013964975681284, 0.6737203421890094) circle (0.0125);
        \draw[color=black, fill=black] (1.453066575688116, 0.8515717132518689) circle (0.0125);
        \draw[color=black, fill=black] (1.3691357489896738, 1.22034803571669) circle (0.0125);
        \draw[color=black, fill=black] (1.4320703933227596, 1.1205804018792187) circle (0.0125);
        \draw[color=black, fill=black] (1.369197656162985, 0.8526758834283965) circle (0.0125);
        \draw[color=black, fill=black] (1.1407157485883874, 1.385989062741165) circle (0.0125);
        \draw[color=black, fill=black] (1.215843315188865, 1.4532190459696759) circle (0.0125);
        \draw[color=black, fill=black] (1.3276347114637628, 1.1186533272038939) circle (0.0125);
        \draw[color=black, fill=black] (1.0670043371528533, 1.4382520272393946) circle (0.0125);
        \draw[color=black, fill=black] (1.2262082634029716, 1.0764298740274536) circle (0.0125);
        \draw[color=black, fill=black] (1.2063649813116086, 0.7436013057369519) circle (0.0125);
        \draw[color=black, fill=black] (1.4416052722670707, 1.0718374995054787) circle (0.0125);
        \draw[color=black, fill=black] (1.0138634053398006, 1.1142162907802058) circle (0.0125);
        \draw[color=black, fill=black] (1.1676563283417456, 1.026381649701169) circle (0.0125);
        \draw[color=black, fill=black] (1.433322497172618, 0.8608380160024373) circle (0.0125);
        \draw[color=black, fill=black] (1.4440541966869047, 1.1202761128970078) circle (0.0125);
        \draw[color=black, fill=black] (1.0200150903521141, 1.4187013029001672) circle (0.0125);
        \draw[color=black, fill=black] (1.340676035820539, 1.4848897791901936) circle (0.0125);
        \draw[color=black, fill=black] (1.094361741464031, 0.6462073558881558) circle (0.0125);
        \draw[color=black, fill=black] (1.4554828449426527, 1.1918977074526527) circle (0.0125);
        \draw[color=black, fill=black] (1.0438500820429797, 1.2490764762874047) circle (0.0125);
        \draw[color=black, fill=black] (1.370591189519092, 1.4124489221578211) circle (0.0125);
        \draw[color=black, fill=black] (1.350474260348524, 0.6336641879228605) circle (0.0125);
        \draw[color=black, fill=black] (1.0219430635739029, 0.5380557122057763) circle (0.0125);
        \draw[color=black, fill=black] (1.0259455818098775, 0.7525557909129698) circle (0.0125);
        \draw[color=black, fill=black] (1.4210132756243719, 1.0378602877331116) circle (0.0125);
        \draw[color=black, fill=black] (1.2750904398757388, 1.3334801200506154) circle (0.0125);
        \draw[color=black, fill=black] (1.0714823246819578, 0.784704087035861) circle (0.0125);
        \draw[color=black, fill=black] (1.2907356539426869, 1.4578558546116827) circle (0.0125);
        \draw[color=black, fill=black] (1.2789893541464623, 0.5306811071386194) circle (0.0125);
        \draw[color=black, fill=black] (1.3928005195232926, 0.7396499169949948) circle (0.0125);
        \draw[color=black, fill=black] (1.3958749679189202, 0.8906641279625674) circle (0.0125);
        \draw[color=black, fill=black] (1.4226823809157287, 1.240943601668755) circle (0.0125);
        \draw[color=black, fill=black] (1.276714111145449, 0.6455438450191678) circle (0.0125);
        \draw[color=black, fill=black] (1.0409609025183004, 0.6308098693472188) circle (0.0125);
        \draw[color=black, fill=black] (1.0336621423087617, 0.6173067758784405) circle (0.0125);
        \draw[color=black, fill=black] (1.1197119358387309, 1.2076642558731097) circle (0.0125);
        \draw[color=black, fill=black] (1.2783655664757176, 0.5247420806551379) circle (0.0125);
        \draw[color=black, fill=black] (1.046687782852506, 1.4555944217502652) circle (0.0125);
        \draw[color=black, fill=black] (1.2823477194119726, 0.7107109037944657) circle (0.0125);
        \draw[color=black, fill=black] (1.1323547286709037, 1.2377302077232155) circle (0.0125);
        \draw[color=black, fill=black] (1.1053290035269263, 1.0793249540914265) circle (0.0125);
        \draw[color=black, fill=black] (1.4732594948169484, 1.3381580814527845) circle (0.0125);
        \draw[color=black, fill=black] (1.1264276855951034, 0.9939254714120117) circle (0.0125);
        \draw[color=black, fill=black] (1.3069789662311555, 1.3207563770614241) circle (0.0125);
        \draw[color=black, fill=black] (1.08697591245689, 0.5306117971229742) circle (0.0125);
        \draw[color=black, fill=black] (1.0457605182666305, 0.986686483163606) circle (0.0125);
        \draw[color=black, fill=black] (1.300506494285332, 1.0671301511593194) circle (0.0125);
        \draw[color=black, fill=black] (1.1632471444280263, 1.4764007505521377) circle (0.0125);
        \draw[color=black, fill=black] (1.2878789791417535, 0.8831376433079616) circle (0.0125);
        \draw[color=black, fill=black] (1.274200404081001, 1.2392010701338396) circle (0.0125);
        \draw[color=black, fill=black] (1.3303856243902628, 0.7707965687212391) circle (0.0125);
        \draw[color=black, fill=black] (1.0440090463535097, 0.8733320929662536) circle (0.0125);
        \draw[color=black, fill=black] (1.3116158158352431, 0.7174196596669686) circle (0.0125);
        \draw[color=black, fill=black] (1.3700588880259366, 0.577373069320262) circle (0.0125);
        \draw[color=black, fill=black] (1.136149671824807, 1.2971356996497618) circle (0.0125);
        \draw[color=black, fill=black] (1.1043812842460807, 1.1359743588579416) circle (0.0125);
        \draw[color=black, fill=black] (1.2617183968337735, 1.4141877711393671) circle (0.0125);
        \draw[color=black, fill=black] (1.1375659659813777, 0.5768120634169231) circle (0.0125);
        \draw[color=black, fill=black] (1.361656332562118, 1.2653735788046656) circle (0.0125);
        \draw[color=black, fill=black] (1.443712529939174, 1.4211727674669163) circle (0.0125);
        \draw[color=black, fill=black] (1.0191269971634085, 0.741003033968385) circle (0.0125);
        \draw[color=black, fill=black] (1.3054697195757874, 1.437790912670426) circle (0.0125);
    
    
        % beam profile
        \def\intensity{2}
        \def\sigma{0.4}
        \def\dsigma{0.35}   
        \def\mu{1.25}
    
        \def\xprofileshift{5.5}
        \draw[->, gray, line width=1pt] (\xprofileshift+0,0) -- (\xprofileshift+3,0) node[right, gray] {$x$};
        \draw[->, gray, line width=1pt] (\xprofileshift+0,0) -- (\xprofileshift+0,2) node[above, gray] {$I$};
        
        \draw[color=black, line width=1pt]    plot (\x+\xprofileshift, {\intensity*exp(-((\x-\mu)/\sigma)^2/\sigma});
        \draw[color=blue, line width=1pt, densely dashed]    plot (\x+\xprofileshift, {\intensity*\sigma/(\sigma+\dsigma)*exp(-((\x-\mu)/(\sigma+\dsigma))^2/(\sigma+\dsigma)});
    \end{tikzpicture}
}


\newcommand{\phaseplusdarkfield}{
    \begin{tikzpicture}[domain=0:3.5, samples=200, scale=1]
    
        % beam to sample
        \draw[->, gray, line width=1pt] (0,0) -- (3.5,0) node[right, gray] {$z$};
        
        \draw[->, black, line width=1pt] (0,1) -- (0.75,1);
        \draw[-, black, line width=1pt] (0,1) -- (1.125,1);
        \draw[draw=red!50!blue!50!, fill=red!50!blue!50!] (1.125, 1) -- (3, 1.5+0.1) -- (3, 1.5-0.1) -- cycle;
        % \draw [draw=black, line width=0.25, fill=gray] (1, 0.5) rectangle (1.5,1.5);
        \draw[draw=black, fill=gray, fill opacity=0.5] (1, 0.5) -- (1, 1.5) -- (1.5, 0.5) -- cycle;
        \draw[->, gray, line width=1pt] (3,0) -- (3,2) node[above, gray] {$x$};
        % \draw[-, color=red] (1.125,1) -- (3,1.5);

        % microstructures in triangle
        \draw[color=black, fill=black] (1.2105854522337227, 0.9114366626930159) circle (0.0125);
        \draw[color=black, fill=black] (1.0125543280382387, 0.7996830937291142) circle (0.0125);
        \draw[color=black, fill=black] (1.0822090481381286, 0.5873479939348674) circle (0.0125);
        \draw[color=black, fill=black] (1.1009736004043937, 0.7796366873311786) circle (0.0125);
        \draw[color=black, fill=black] (1.2009645502595683, 0.8212801904106449) circle (0.0125);
        \draw[color=black, fill=black] (1.2116173943415651, 0.8905802824348579) circle (0.0125);
        \draw[color=black, fill=black] (1.1096148186224708, 1.1761551334427267) circle (0.0125);
        \draw[color=black, fill=black] (1.025509106769015, 1.1319997678193492) circle (0.0125);
        \draw[color=black, fill=black] (1.2107197811243853, 0.8217685860015895) circle (0.0125);
        \draw[color=black, fill=black] (1.079183795832736, 0.6742760961260408) circle (0.0125);
        \draw[color=black, fill=black] (1.39285367012088, 0.6957848090096292) circle (0.0125);
        \draw[color=black, fill=black] (1.1613764846256402, 0.9640653703904971) circle (0.0125);
        \draw[color=black, fill=black] (1.4287848473406182, 0.6175539336354573) circle (0.0125);
        \draw[color=black, fill=black] (1.0528960004006445, 0.546446729992993) circle (0.0125);
        \draw[color=black, fill=black] (1.0931694492931703, 1.2050568339527892) circle (0.0125);
        \draw[color=black, fill=black] (1.0592147460706987, 0.8732083722137076) circle (0.0125);
        \draw[color=black, fill=black] (1.4674975268214885, 0.5338292486247724) circle (0.0125);
        \draw[color=black, fill=black] (1.3411416291264748, 0.6048567074783593) circle (0.0125);
        \draw[color=black, fill=black] (1.3385879406487522, 0.7610716551793134) circle (0.0125);
        \draw[color=black, fill=black] (1.021186931738491, 1.2121041942818311) circle (0.0125);
        \draw[color=black, fill=black] (1.482209017230585, 0.5204170631719836) circle (0.0125);
        \draw[color=black, fill=black] (1.1457108962305924, 1.0520341485903084) circle (0.0125);
        \draw[color=black, fill=black] (1.0615323531243799, 0.8940763027919485) circle (0.0125);
        \draw[color=black, fill=black] (1.4440828639692205, 0.537995770841003) circle (0.0125);
        \draw[color=black, fill=black] (1.1491932858285157, 0.6004790779634888) circle (0.0125);
        \draw[color=black, fill=black] (1.0216993049883911, 1.1449041260839543) circle (0.0125);
        \draw[color=black, fill=black] (1.113023355100028, 0.711382044132214) circle (0.0125);
        \draw[color=black, fill=black] (1.2459972506581607, 0.5382744027153057) circle (0.0125);
        \draw[color=black, fill=black] (1.2852058626087062, 0.5718646609824494) circle (0.0125);
        \draw[color=black, fill=black] (1.29242013002906, 0.7855175397679228) circle (0.0125);
        \draw[color=black, fill=black] (1.0611088536932172, 0.8655996145631462) circle (0.0125);
        \draw[color=black, fill=black] (1.3423400749206789, 0.6327444634678663) circle (0.0125);
        \draw[color=black, fill=black] (1.0362278929993913, 0.9961702004630928) circle (0.0125);
        \draw[color=black, fill=black] (1.3278024564793998, 0.6769530527624299) circle (0.0125);
        \draw[color=black, fill=black] (1.4611825090956363, 0.5433733138866398) circle (0.0125);
        \draw[color=black, fill=black] (1.4416159097617447, 0.5251158034610468) circle (0.0125);
        \draw[color=black, fill=black] (1.0786562649441103, 1.17269374025518) circle (0.0125);
        \draw[color=black, fill=black] (1.2013964975681284, 0.6071168298739291) circle (0.0125);
        \draw[color=black, fill=black] (1.453066575688116, 0.5364495388196083) circle (0.0125);
        \draw[color=black, fill=black] (1.3691357489896738, 0.6843644155420239) circle (0.0125);
        \draw[color=black, fill=black] (1.4320703933227596, 0.5816398102652376) circle (0.0125);
        \draw[color=black, fill=black] (1.369197656162985, 0.5950509832336544) circle (0.0125);
        \draw[color=black, fill=black] (1.1407157485883874, 1.1338584630542075) circle (0.0125);
        \draw[color=black, fill=black] (1.215843315188865, 1.0367104971626993) circle (0.0125);
        \draw[color=black, fill=black] (1.3276347114637628, 0.7112751313859501) circle (0.0125);
        \draw[color=black, fill=black] (1.0670043371528533, 1.311012230412552) circle (0.0125);
        \draw[color=black, fill=black] (1.2262082634029716, 0.8147568535457985) circle (0.0125);
        \draw[color=black, fill=black] (1.2063649813116086, 0.645773169040553) circle (0.0125);
        \draw[color=black, fill=black] (1.4416052722670707, 0.5651577276935824) circle (0.0125);
        \draw[color=black, fill=black] (1.0138634053398006, 1.097104830598365) circle (0.0125);
        
        % beam profile
        \def\intensity{2}
        \def\sigma{0.4}
        \def\dsigma{0.35}
        \def\mu{1.25}
    
        % \def\xprofileshift{5.5}
        % \draw[->, gray, line width=1pt] (\xprofileshift+0,0) -- (\xprofileshift+4,0) node[right, gray] {$x$};
        % \draw[->, gray, line width=1pt] (\xprofileshift+0,0) -- (\xprofileshift+0,2) node[above, gray] {$I$};
        
        % \draw[color=black, line width=1pt]    plot (\x+\xprofileshift, {\intensity*exp(-((\x-\mu)/\sigma)^2/\sigma});
        % \draw[color=red!50!blue!50!, line width=1pt, densely dashed]    plot (\x+\xprofileshift, {\intensity*\sigma/(\sigma+\dsigma)*exp(-((\x-(\mu+0.5))/(\sigma+\dsigma))^2/(\sigma+\dsigma)});
        
    \end{tikzpicture}
}